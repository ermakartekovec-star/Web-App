<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STARFORGE: –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–≤–æ–µ–≤–∞—Ç–µ–ª—å</title>
    <style>
        /* === –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
            user-select: none;
        }

        body {
            background: #000;
            color: #0ff;
            overflow: hidden;
            height: 100vh;
            position: relative;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 40, 80, 0.2) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(80, 0, 40, 0.2) 0%, transparent 20%),
                linear-gradient(45deg, #000 0%, #001122 100%);
        }

        /* === –ö–û–ù–¢–ï–ô–ù–ï–† –ò–ì–†–´ === */
        #game-container {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        /* === –ö–ê–ù–í–ê–° –î–õ–Ø –ò–ì–†–´ === */
        #game-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            filter: contrast(1.2) saturate(1.1);
        }

        /* === –≠–§–§–ï–ö–¢–´ –ü–ê–†–ê–õ–õ–ê–ö–°–ê (–∑–≤–µ–∑–¥—ã) === */
        .parallax-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 300%;
            height: 300%;
            pointer-events: none;
            z-index: 0;
        }

        .stars {
            background: transparent;
            animation: stars-move 200s linear infinite;
        }

        .stars2 {
            background: transparent;
            animation: stars-move 150s linear infinite;
            opacity: 0.6;
        }

        .stars3 {
            background: transparent;
            animation: stars-move 100s linear infinite;
            opacity: 0.4;
        }

        @keyframes stars-move {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-66.66%, -66.66%); }
        }

        /* === –ò–ù–¢–ï–†–§–ï–ô–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø === */
        #ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
        }

        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–∞ */
        .status-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 20, 40, 0.8);
            border: 2px solid #0ff;
            border-radius: 10px;
            padding: 15px;
            min-width: 300px;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
            pointer-events: auto;
        }

        .status-item {
            margin: 10px 0;
            display: flex;
            align-items: center;
        }

        .status-label {
            color: #8af;
            width: 120px;
            font-size: 14px;
        }

        .status-value {
            color: #0ff;
            font-weight: bold;
            font-size: 16px;
        }

        .health-bar, .shield-bar, .energy-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
            margin-left: 10px;
            flex-grow: 1;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #f00, #ff0);
            transition: width 0.3s ease;
            border-radius: 6px;
        }

        .shield-fill {
            height: 100%;
            background: linear-gradient(90deg, #00f, #0ff);
            transition: width 0.3s ease;
            border-radius: 6px;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #0f0, #ff0);
            transition: width 0.3s ease;
            border-radius: 6px;
        }

        /* –ü–∞–Ω–µ–ª—å –≤–æ–æ—Ä—É–∂–µ–Ω–∏—è */
        .weapon-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 20, 40, 0.8);
            border: 2px solid #f0f;
            border-radius: 10px;
            padding: 15px;
            width: 400px;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.3);
            pointer-events: auto;
        }

        .weapon-slot {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .weapon-slot.active {
            background: rgba(255, 0, 255, 0.2);
            border: 1px solid #f0f;
        }

        .weapon-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #333, #666);
            border-radius: 5px;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #fff;
        }

        .weapon-info {
            flex-grow: 1;
        }

        .weapon-name {
            color: #f8f;
            font-weight: bold;
        }

        .weapon-stats {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #8af;
        }

        /* –ú–∏–Ω–∏–∫–∞—Ä—Ç–∞ */
        .minimap {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 200px;
            height: 200px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #0f0;
            border-radius: 10px;
            overflow: hidden;
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        .minimap-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 0, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* –ú–µ–Ω—é –º–∏—Å—Å–∏–π */
        .mission-panel {
            position: absolute;
            top: 240px;
            right: 20px;
            width: 250px;
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #ff0;
            border-radius: 10px;
            padding: 15px;
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        .mission-title {
            color: #ff0;
            font-size: 16px;
            margin-bottom: 10px;
            text-align: center;
        }

        .mission-item {
            background: rgba(255, 255, 0, 0.1);
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            font-size: 12px;
        }

        .mission-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        /* –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .message-log {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 300px;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #888;
            border-radius: 5px;
            padding: 10px;
            overflow-y: auto;
            font-size: 12px;
            pointer-events: auto;
        }

        .message {
            margin: 5px 0;
            padding: 3px;
            border-left: 3px solid #0ff;
            padding-left: 10px;
            animation: message-fade 10s forwards;
        }

        @keyframes message-fade {
            0%, 80% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* –≠–ö–†–ê–ù–´ –ú–ï–ù–Æ === */
        .menu-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #001122 0%, #000 70%);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #0ff;
        }

        .menu-title {
            font-size: 5em;
            text-align: center;
            margin-bottom: 50px;
            text-shadow: 
                0 0 10px #0ff,
                0 0 20px #0ff,
                0 0 30px #0ff;
            animation: title-glow 2s infinite alternate;
        }

        @keyframes title-glow {
            from { text-shadow: 0 0 10px #0ff, 0 0 20px #0ff; }
            to { text-shadow: 0 0 20px #0ff, 0 0 30px #0ff, 0 0 40px #0ff; }
        }

        .menu-subtitle {
            font-size: 1.5em;
            color: #8af;
            margin-bottom: 100px;
            text-align: center;
        }

        .menu-button {
            background: linear-gradient(45deg, #001133, #003366);
            border: 2px solid #0ff;
            color: #0ff;
            padding: 15px 40px;
            margin: 15px;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .menu-button:hover {
            background: linear-gradient(45deg, #003366, #0055aa);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.7);
            transform: scale(1.05);
        }

        .menu-button:active {
            transform: scale(0.95);
        }

        .button-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 30px;
        }

        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê === */
        .modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 10, 30, 0.95);
            border: 3px solid #0ff;
            border-radius: 15px;
            padding: 30px;
            min-width: 500px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            display: none;
        }

        .modal.active {
            display: block;
            animation: modal-appear 0.5s ease;
        }

        @keyframes modal-appear {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        .modal-title {
            color: #0ff;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-content {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }

        /* –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ === */
        .explosion {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #ff0 0%, #f00 70%, transparent 100%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 5;
            animation: explode 0.5s forwards;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(3); opacity: 0; }
        }

        .powerup {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #0ff 0%, #00f 100%);
            border-radius: 50%;
            animation: float 2s infinite alternate;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-20px) rotate(360deg); }
        }

        /* –ê–ù–ò–ú–ê–¶–ò–ò –î–õ–Ø –í–†–ê–ì–û–í === */
        @keyframes enemy-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes boss-enter {
            0% { transform: translateY(-100vh) scale(0.5); }
            100% { transform: translateY(0) scale(1); }
        }

        /* –°–ò–°–¢–ï–ú–ù–´–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø === */
        .notification {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #f00;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 24px;
            color: #fff;
            z-index: 100;
            text-align: center;
            display: none;
            animation: pulse 0.5s infinite alternate;
        }

        @keyframes pulse {
            from { box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); }
            to { box-shadow: 0 0 30px rgba(255, 0, 0, 0.8); }
        }

        /* –ó–ê–ì–†–£–ó–û–ß–ù–´–ô –≠–ö–†–ê–ù === */
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .loading-text {
            color: #0ff;
            font-size: 24px;
            margin-bottom: 30px;
        }

        .loading-bar {
            width: 300px;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #00f, #0ff);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ === */
        @media (max-width: 1200px) {
            .status-panel, .weapon-panel, .mission-panel, .minimap, .message-log {
                transform: scale(0.9);
                transform-origin: top left;
            }
            
            .menu-title {
                font-size: 3em;
            }
        }

        @media (max-width: 768px) {
            .menu-title {
                font-size: 2em;
            }
            
            .modal {
                min-width: 90%;
                padding: 15px;
            }
        }

        /* –°–ö–†–û–õ–õ–ë–ê–† === */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 255, 255, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(#0ff, #00f);
            border-radius: 4px;
        }

        /* –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ö–õ–ê–°–°–´ === */
        .hidden {
            display: none !important;
        }

        .visible {
            display: block !important;
        }

        .blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .vibrate {
            animation: vibrate 0.3s linear infinite;
        }

        @keyframes vibrate {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(-2px, -2px); }
            50% { transform: translate(2px, 2px); }
            75% { transform: translate(-2px, 2px); }
        }

        /* –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ === */
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.5), transparent);
            animation: scan 3s linear infinite;
            z-index: 2;
            pointer-events: none;
        }

        @keyframes scan {
            0% { top: 0%; }
            100% { top: 100%; }
        }

        .damage-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 0, 0, 0.2);
            pointer-events: none;
            z-index: 3;
            opacity: 0;
        }

        .damage-flash {
            animation: damage-flash 0.3s;
        }

        @keyframes damage-flash {
            0%, 100% { opacity: 0; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <!-- –ó–ê–ì–†–£–ó–û–ß–ù–´–ô –≠–ö–†–ê–ù -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-text">–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ò–°–¢–ï–ú –ö–û–†–ê–ë–õ–Ø...</div>
        <div class="loading-bar">
            <div id="loading-progress" class="loading-progress"></div>
        </div>
        <div id="loading-status" style="color: #8af; margin-top: 20px; font-size: 14px;">
            –ó–∞–≥—Ä—É–∑–∫–∞ —è–¥–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º...
        </div>
    </div>

    <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
    <div id="main-menu" class="menu-screen hidden">
        <div class="menu-title">STARFORGE</div>
        <div class="menu-subtitle">–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–≤–æ–µ–≤–∞—Ç–µ–ª—å</div>
        <div class="button-group">
            <div class="menu-button" onclick="startNewGame()">–ù–û–í–ê–Ø –ò–ì–†–ê</div>
            <div class="menu-button" onclick="continueGame()">–ü–†–û–î–û–õ–ñ–ò–¢–¨</div>
            <div class="menu-button" onclick="showOptions()">–ù–ê–°–¢–†–û–ô–ö–ò</div>
            <div class="menu-button" onclick="showCredits()">–ê–í–¢–û–†–´</div>
            <div class="menu-button" onclick="quitGame()">–í–´–•–û–î</div>
        </div>
    </div>

    <!-- –ò–ì–†–û–í–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† -->
    <div id="game-container">
        <!-- –°–õ–û–ò –ü–ê–†–ê–õ–õ–ê–ö–°–ê (–ó–í–ï–ó–î–´) -->
        <div class="parallax-layer stars"></div>
        <div class="parallax-layer stars2"></div>
        <div class="parallax-layer stars3"></div>
        
        <!-- –ö–ê–ù–í–ê–° –î–õ–Ø –û–°–ù–û–í–ù–û–ô –ì–†–ê–§–ò–ö–ò -->
        <canvas id="game-canvas"></canvas>
        
        <!-- –ò–ù–¢–ï–†–§–ï–ô–° -->
        <div id="ui-overlay">
            <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–∞ -->
            <div class="status-panel">
                <div class="status-item">
                    <span class="status-label">–≠–ù–ï–†–ì–û–©–ò–¢–´:</span>
                    <div class="shield-bar">
                        <div id="shield-fill" class="shield-fill" style="width: 100%"></div>
                    </div>
                </div>
                <div class="status-item">
                    <span class="status-label">–ö–û–†–ü–£–°:</span>
                    <div class="health-bar">
                        <div id="health-fill" class="health-fill" style="width: 100%"></div>
                    </div>
                </div>
                <div class="status-item">
                    <span class="status-label">–†–ï–ê–ö–¢–û–†:</span>
                    <div class="energy-bar">
                        <div id="energy-fill" class="energy-fill" style="width: 100%"></div>
                    </div>
                </div>
                <div class="status-item">
                    <span class="status-label">–°–ö–û–†–û–°–¢–¨:</span>
                    <span id="speed-value" class="status-value">0 –∫–º/—Å</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–û–ß–ö–ò:</span>
                    <span id="score-value" class="status-value">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–£–†–û–í–ï–ù–¨:</span>
                    <span id="level-value" class="status-value">1</span>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å –≤–æ–æ—Ä—É–∂–µ–Ω–∏—è -->
            <div class="weapon-panel">
                <div class="weapon-slot active" data-weapon="0">
                    <div class="weapon-icon">‚ö°</div>
                    <div class="weapon-info">
                        <div class="weapon-name">–ü–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞</div>
                        <div class="weapon-stats">
                            <span>–£—Ä–æ–Ω: 15</span>
                            <span>–°–∫–æ—Ä–æ—Å—Ç—å: 1000–º/—Å</span>
                            <span>–¢–µ–ø–ª–æ: 20%</span>
                        </div>
                    </div>
                </div>
                <div class="weapon-slot" data-weapon="1">
                    <div class="weapon-icon">üí£</div>
                    <div class="weapon-info">
                        <div class="weapon-name">–ü—Ä–æ—Ç–æ–Ω–Ω–∞—è —Ç–æ—Ä–ø–µ–¥–∞</div>
                        <div class="weapon-stats">
                            <span>–£—Ä–æ–Ω: 150</span>
                            <span>–ó–∞—Ä—è–¥—ã: 5/5</span>
                            <span>–ù–∞–≤–µ–¥–µ–Ω–∏–µ: –î–ê</span>
                        </div>
                    </div>
                </div>
                <div class="weapon-slot" data-weapon="2">
                    <div class="weapon-icon">üåÄ</div>
                    <div class="weapon-info">
                        <div class="weapon-name">–ò–æ–Ω–Ω—ã–π –∏–∑–ª—É—á–∞—Ç–µ–ª—å</div>
                        <div class="weapon-stats">
                            <span>–£—Ä–æ–Ω: 30/—Å</span>
                            <span>–î–∞–ª—å–Ω–æ—Å—Ç—å: 200–º</span>
                            <span>–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: 15/—Å</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ú–∏–Ω–∏–∫–∞—Ä—Ç–∞ -->
            <div class="minimap">
                <div class="minimap-grid"></div>
                <canvas id="minimap-canvas" width="200" height="200"></canvas>
            </div>

            <!-- –ú–µ–Ω—é –º–∏—Å—Å–∏–π -->
            <div class="mission-panel">
                <div class="mission-title">–ó–ê–î–ê–ù–ò–Ø</div>
                <div id="mission-list">
                    <div class="mission-item" data-mission="1">‚úì –£–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Ä–∞–∑–≤–µ–¥—á–∏–∫–æ–≤ (3/3)</div>
                    <div class="mission-item" data-mission="2">‚Üí –ó–∞—â–∏—Ç–∏—Ç—å –∫–æ–Ω–≤–æ–π</div>
                    <div class="mission-item" data-mission="3">‚Ä¢ –°–æ–±—Ä–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (0/5)</div>
                    <div class="mission-item" data-mission="4">‚Ä¢ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—å —Å–µ–∫—Ç–æ—Ä–∞ –ê–ª—å—Ñ–∞</div>
                </div>
            </div>

            <!-- –õ–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π -->
            <div class="message-log">
                <div id="messages-container">
                    <div class="message">–°–∏—Å—Ç–µ–º—ã –æ–Ω–ª–∞–π–Ω. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –∫–æ–º–∞–Ω–¥–∏—Ä.</div>
                    <div class="message">–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤—Ä–∞–∂–µ—Å–∫–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –Ω–∞ —Ä–∞–¥–∞—Ä–µ.</div>
                    <div class="message">–≠–Ω–µ—Ä–≥–æ—â–∏—Ç—ã –Ω–∞ 100%.</div>
                </div>
            </div>
        </div>

        <!-- –°–ö–ê–ù-–õ–ò–ù–ò–Ø -->
        <div class="scan-line"></div>

        <!-- –û–í–ï–†–õ–ï–ô –ü–û–í–†–ï–ñ–î–ï–ù–ò–ô -->
        <div id="damage-overlay" class="damage-overlay"></div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
    
    <!-- –û–ö–ù–û –ù–ê–°–¢–†–û–ï–ö -->
    <div id="options-modal" class="modal">
        <div class="modal-title">–ù–ê–°–¢–†–û–ô–ö–ò</div>
        <div class="modal-content">
            <div style="margin: 15px 0;">
                <label style="color: #8af; display: block; margin: 10px 0;">–ì–†–û–ú–ö–û–°–¢–¨: <span id="volume-value">70%</span></label>
                <input type="range" id="volume-slider" min="0" max="100" value="70" style="width: 100%;">
            </div>
            <div style="margin: 15px 0;">
                <label style="color: #8af; display: block; margin: 10px 0;">–ß–£–í–°–¢–í–ò–¢–ï–õ–¨–ù–û–°–¢–¨: <span id="sensitivity-value">50%</span></label>
                <input type="range" id="sensitivity-slider" min="1" max="100" value="50" style="width: 100%;">
            </div>
            <div style="margin: 15px 0;">
                <label style="color: #8af; display: flex; align-items: center;">
                    <input type="checkbox" id="fullscreen-toggle" style="margin-right: 10px;">
                    –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
                </label>
            </div>
            <div style="margin: 15px 0;">
                <label style="color: #8af; display: flex; align-items: center;">
                    <input type="checkbox" id="vibration-toggle" checked style="margin-right: 10px;">
                    –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ—Ç–¥–∞—á–∞
                </label>
            </div>
            <div style="margin: 15px 0;">
                <label style="color: #8af; display: block; margin: 10px 0;">–ö–ê–ß–ï–°–¢–í–û –ì–†–ê–§–ò–ö–ò:</label>
                <select id="graphics-quality" style="width: 100%; padding: 8px; background: #001133; color: #0ff; border: 1px solid #0ff;">
                    <option value="low">–ù–∏–∑–∫–æ–µ</option>
                    <option value="medium" selected>–°—Ä–µ–¥–Ω–µ–µ</option>
                    <option value="high">–í—ã—Å–æ–∫–æ–µ</option>
                    <option value="ultra">–£–ª—å—Ç—Ä–∞</option>
                </select>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <div class="menu-button" onclick="saveOptions()" style="display: inline-block; margin: 5px;">–°–û–•–†–ê–ù–ò–¢–¨</div>
                <div class="menu-button" onclick="closeOptions()" style="display: inline-block; margin: 5px;">–û–¢–ú–ï–ù–ê</div>
            </div>
        </div>
    </div>

    <!-- –û–ö–ù–û –ê–í–¢–û–†–û–í -->
    <div id="credits-modal" class="modal">
        <div class="modal-title">–ê–í–¢–û–†–´</div>
        <div class="modal-content">
            <div style="text-align: center; margin: 20px 0;">
                <div style="color: #0ff; font-size: 1.2em; margin: 10px 0;">STARFORGE: –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–≤–æ–µ–≤–∞—Ç–µ–ª—å</div>
                <div style="color: #8af; margin: 10px 0;">–í–µ—Ä—Å–∏—è 1.0.0</div>
            </div>
            <div style="margin: 20px 0;">
                <div style="color: #ff0; margin: 15px 0;">–ì–õ–ê–í–ù–´–ô –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö:</div>
                <div style="color: #8af;">NeoStellar Interactive</div>
            </div>
            <div style="margin: 20px 0;">
                <div style="color: #ff0; margin: 15px 0;">–í–ï–î–£–©–ò–ô –î–ò–ó–ê–ô–ù–ï–†:</div>
                <div style="color: #8af;">–ê–ª–µ–∫—Å–µ–π "Void" –ü–µ—Ç—Ä–æ–≤</div>
            </div>
            <div style="margin: 20px 0;">
                <div style="color: #ff0; margin: 15px 0;">–°–¶–ï–ù–ê–†–ò–°–¢–´:</div>
                <div style="color: #8af;">–ú–∞—Ä–∏—è "Nova" –°–º–∏—Ä–Ω–æ–≤–∞</div>
                <div style="color: #8af;">–î–º–∏—Ç—Ä–∏–π "Orion" –ö–æ–∑–ª–æ–≤</div>
            </div>
            <div style="margin: 20px 0;">
                <div style="color: #ff0; margin: 15px 0;">–°–ü–ï–¶–ò–ê–õ–¨–ù–ê–Ø –ë–õ–ê–ì–û–î–ê–†–ù–û–°–¢–¨:</div>
                <div style="color: #8af;">–í—Å–µ–º —Ç–µ—Å—Ç–µ—Ä–∞–º –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤—É</div>
            </div>
            <div style="border-top: 1px solid #0ff; padding-top: 20px; margin-top: 20px; text-align: center;">
                <div style="color: #888; font-size: 0.9em;">¬© 2024 NeoStellar Interactive. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <div class="menu-button" onclick="closeCredits()" style="display: inline-block;">–ó–ê–ö–†–´–¢–¨</div>
            </div>
        </div>
    </div>

    <!-- –û–ö–ù–û –ü–ê–£–ó–´ -->
    <div id="pause-modal" class="modal hidden">
        <div class="modal-title">–ü–ê–£–ó–ê</div>
        <div class="modal-content" style="text-align: center;">
            <div class="menu-button" onclick="resumeGame()" style="margin: 10px auto;">–ü–†–û–î–û–õ–ñ–ò–¢–¨</div>
            <div class="menu-button" onclick="showOptions()" style="margin: 10px auto;">–ù–ê–°–¢–†–û–ô–ö–ò</div>
            <div class="menu-button" onclick="saveGame()" style="margin: 10px auto;">–°–û–•–†–ê–ù–ò–¢–¨ –ò–ì–†–£</div>
            <div class="menu-button" onclick="returnToMenu()" style="margin: 10px auto;">–í –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</div>
        </div>
    </div>

    <!-- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø -->
    <div id="notification" class="notification"></div>

    <!-- –ê–£–î–ò–û –≠–õ–ï–ú–ï–ù–¢–´ (—Å–∫—Ä—ã—Ç—ã–µ) -->
    <audio id="laser-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==">
    </audio>
    <audio id="explosion-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==">
    </audio>
    <audio id="engine-sound" preload="auto" loop>
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==">
    </audio>

    <script>
        // ==================== –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        const GameState = {
            MENU: 'menu',
            PLAYING: 'playing',
            PAUSED: 'paused',
            GAME_OVER: 'game_over',
            WIN: 'win'
        };

        let currentState = GameState.MENU;
        let game = {
            score: 0,
            level: 1,
            health: 100,
            shield: 100,
            energy: 100,
            speed: 0,
            weapons: [
                { name: "–ü–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞", damage: 15, heat: 0, maxHeat: 100 },
                { name: "–ü—Ä–æ—Ç–æ–Ω–Ω–∞—è —Ç–æ—Ä–ø–µ–¥–∞", damage: 150, ammo: 5, maxAmmo: 5 },
                { name: "–ò–æ–Ω–Ω—ã–π –∏–∑–ª—É—á–∞—Ç–µ–ª—å", damage: 30, energyCost: 15 }
            ],
            activeWeapon: 0,
            missions: [
                { id: 1, name: "–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Ä–∞–∑–≤–µ–¥—á–∏–∫–æ–≤", completed: true, progress: 3, total: 3 },
                { id: 2, name: "–ó–∞—â–∏—Ç–∏—Ç—å –∫–æ–Ω–≤–æ–π", completed: false, progress: 0, total: 1 },
                { id: 3, name: "–°–æ–±—Ä–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã", completed: false, progress: 0, total: 5 },
                { id: 4, name: "–î–æ—Å—Ç–∏–≥–Ω—É—Ç—å —Å–µ–∫—Ç–æ—Ä–∞ –ê–ª—å—Ñ–∞", completed: false, progress: 0, total: 1 }
            ],
            enemies: [],
            projectiles: [],
            particles: [],
            powerups: []
        };

        // –ö–∞–Ω–≤–∞—Å—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const minimapCanvas = document.getElementById('minimap-canvas');
        const minimapCtx = minimapCanvas.getContext('2d');

        // –†–∞–∑–º–µ—Ä—ã –∫–∞–Ω–≤–∞—Å–∞
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        // ==================== –ö–õ–ê–°–°–´ –ò–ì–†–´ ====================

        class Vector2 {
            constructor(x = 0, y = 0) {
                this.x = x;
                this.y = y;
            }

            add(v) {
                return new Vector2(this.x + v.x, this.y + v.y);
            }

            subtract(v) {
                return new Vector2(this.x - v.x, this.y - v.y);
            }

            multiply(scalar) {
                return new Vector2(this.x * scalar, this.y * scalar);
            }

            distanceTo(v) {
                const dx = this.x - v.x;
                const dy = this.y - v.y;
                return Math.sqrt(dx * dx + dy * dy);
            }

            normalize() {
                const length = Math.sqrt(this.x * this.x + this.y * this.y);
                if (length === 0) return new Vector2(0, 0);
                return new Vector2(this.x / length, this.y / length);
            }
        }

        class GameObject {
            constructor(position, velocity, size, color) {
                this.position = position;
                this.velocity = velocity;
                this.size = size;
                this.color = color;
                this.active = true;
                this.rotation = 0;
            }

            update(deltaTime) {
                this.position = this.position.add(this.velocity.multiply(deltaTime));
            }

            draw(ctx) {
                ctx.save();
                ctx.translate(this.position.x, this.position.y);
                ctx.rotate(this.rotation);
                ctx.fillStyle = this.color;
                ctx.fillRect(-this.size.x / 2, -this.size.y / 2, this.size.x, this.size.y);
                ctx.restore();
            }

            isOutOfBounds(bounds) {
                return (
                    this.position.x < -100 ||
                    this.position.x > bounds.width + 100 ||
                    this.position.y < -100 ||
                    this.position.y > bounds.height + 100
                );
            }
        }

        class Player extends GameObject {
            constructor() {
                super(
                    new Vector2(canvas.width / 2, canvas.height / 2),
                    new Vector2(0, 0),
                    new Vector2(40, 60),
                    '#00ffff'
                );
                this.maxSpeed = 500;
                this.acceleration = 800;
                this.rotationSpeed = 5;
                this.enginePower = 0;
                this.lastShot = 0;
                this.shootCooldown = 200; // –º—Å
            }

            update(deltaTime, input) {
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤–æ—Ä–æ—Ç–æ–º
                if (input.left) this.rotation -= this.rotationSpeed * deltaTime;
                if (input.right) this.rotation += this.rotationSpeed * deltaTime;

                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–µ–º
                if (input.up) {
                    this.enginePower = Math.min(this.enginePower + deltaTime * 2, 1);
                } else if (input.down) {
                    this.enginePower = Math.max(this.enginePower - deltaTime * 2, -0.5);
                } else {
                    this.enginePower *= 0.95;
                }

                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
                const accelerationVector = new Vector2(
                    Math.sin(this.rotation) * this.acceleration * this.enginePower,
                    -Math.cos(this.rotation) * this.acceleration * this.enginePower
                );

                this.velocity = this.velocity.add(accelerationVector.multiply(deltaTime));

                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
                const speed = Math.sqrt(this.velocity.x * this.velocity.x + this.velocity.y * this.velocity.y);
                if (speed > this.maxSpeed) {
                    this.velocity = this.velocity.multiply(this.maxSpeed / speed);
                }

                // –¢—Ä–µ–Ω–∏–µ
                this.velocity = this.velocity.multiply(0.98);

                super.update(deltaTime);

                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —ç–∫—Ä–∞–Ω–∞
                this.position.x = Math.max(50, Math.min(canvas.width - 50, this.position.x));
                this.position.y = Math.max(50, Math.min(canvas.height - 50, this.position.y));

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                game.speed = Math.round(speed);
                document.getElementById('speed-value').textContent = `${game.speed} –∫–º/—Å`;
            }

            draw(ctx) {
                ctx.save();
                ctx.translate(this.position.x, this.position.y);
                ctx.rotate(this.rotation);

                // –ö–æ—Ä–ø—É—Å –∫–æ—Ä–∞–±–ª—è
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.moveTo(0, -this.size.y / 2);
                ctx.lineTo(this.size.x / 2, this.size.y / 2);
                ctx.lineTo(0, this.size.y / 4);
                ctx.lineTo(-this.size.x / 2, this.size.y / 2);
                ctx.closePath();
                ctx.fill();

                // –î–≤–∏–≥–∞—Ç–µ–ª—å
                if (this.enginePower > 0.1) {
                    const flameSize = 20 + this.enginePower * 30;
                    const gradient = ctx.createLinearGradient(0, this.size.y / 4, 0, this.size.y / 4 + flameSize);
                    gradient.addColorStop(0, '#ffff00');
                    gradient.addColorStop(0.5, '#ff5500');
                    gradient.addColorStop(1, '#ff0000');

                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.ellipse(0, this.size.y / 4 + flameSize / 2, 10, flameSize / 2, 0, 0, Math.PI * 2);
                    ctx.fill();

                    // –ß–∞—Å—Ç–∏—Ü—ã –¥–≤–∏–≥–∞—Ç–µ–ª—è
                    for (let i = 0; i < 5; i++) {
                        const particle = {
                            x: (Math.random() - 0.5) * 20,
                            y: this.size.y / 4 + flameSize + Math.random() * 20,
                            size: Math.random() * 3 + 2,
                            speed: Math.random() * 100 + 50,
                            life: 0.5
                        };
                        game.particles.push(particle);
                    }
                }

                ctx.restore();
            }

            shoot() {
                const currentTime = Date.now();
                if (currentTime - this.lastShot < this.shootCooldown) return;

                const weapon = game.weapons[game.activeWeapon];
                
                switch(game.activeWeapon) {
                    case 0: // –ü–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞
                        const projectile = new Projectile(
                            this.position.add(new Vector2(
                                Math.sin(this.rotation) * 30,
                                -Math.cos(this.rotation) * 30
                            )),
                            new Vector2(
                                Math.sin(this.rotation) * 1000,
                                -Math.cos(this.rotation) * 1000
                            ).add(this.velocity),
                            new Vector2(6, 6),
                            '#00ffff',
                            weapon.damage,
                            this
                        );
                        game.projectiles.push(projectile);
                        weapon.heat += 20;
                        playSound('laser-sound');
                        break;

                    case 1: // –ü—Ä–æ—Ç–æ–Ω–Ω–∞—è —Ç–æ—Ä–ø–µ–¥–∞
                        if (weapon.ammo > 0) {
                            const torpedo = new Projectile(
                                this.position.add(new Vector2(
                                    Math.sin(this.rotation) * 30,
                                    -Math.cos(this.rotation) * 30
                                )),
                                new Vector2(
                                    Math.sin(this.rotation) * 500,
                                    -Math.cos(this.rotation) * 500
                                ).add(this.velocity),
                                new Vector2(15, 15),
                                '#ff00ff',
                                weapon.damage,
                                this
                            );
                            torpedo.homing = true;
                            game.projectiles.push(torpedo);
                            weapon.ammo--;
                            playSound('explosion-sound');
                        }
                        break;
                }

                this.lastShot = currentTime;
                updateWeaponDisplay();
            }
        }

        class Enemy extends GameObject {
            constructor(type = 0) {
                let size, color, health;
                
                switch(type) {
                    case 0: // –†–∞–∑–≤–µ–¥—á–∏–∫
                        size = new Vector2(30, 30);
                        color = '#ff5555';
                        health = 50;
                        break;
                    case 1: // –ò—Å—Ç—Ä–µ–±–∏—Ç–µ–ª—å
                        size = new Vector2(40, 40);
                        color = '#ff0000';
                        health = 100;
                        break;
                    case 2: // –ë–æ—Å—Å
                        size = new Vector2(100, 100);
                        color = '#ff00ff';
                        health = 500;
                        break;
                }

                super(
                    new Vector2(
                        Math.random() * canvas.width * 0.8 + canvas.width * 0.1,
                        -50
                    ),
                    new Vector2(0, 50 + Math.random() * 50),
                    size,
                    color
                );

                this.type = type;
                this.health = health;
                this.maxHealth = health;
                this.shootTimer = 0;
                this.pattern = Math.floor(Math.random() * 3);
                this.animationTime = 0;
            }

            update(deltaTime, player) {
                this.animationTime += deltaTime;

                // –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–≤–∏–∂–µ–Ω–∏—è
                switch(this.pattern) {
                    case 0: // –ü—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–µ
                        this.velocity.y = 50;
                        this.position.x += Math.sin(this.animationTime) * 100 * deltaTime;
                        break;
                    case 1: // –í–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ
                        this.velocity.y = 30;
                        this.position.x += Math.sin(this.animationTime * 2) * 200 * deltaTime;
                        break;
                    case 2: // –ê—Ç–∞–∫—É—é—â–µ–µ
                        const direction = player.position.subtract(this.position).normalize();
                        this.velocity = direction.multiply(100);
                        break;
                }

                super.update(deltaTime);

                // –°—Ç—Ä–µ–ª—å–±–∞
                this.shootTimer -= deltaTime;
                if (this.shootTimer <= 0 && Math.random() < 0.01) {
                    this.shoot(player);
                    this.shootTimer = 1 + Math.random();
                }

                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–∞—Ä–µ–Ω–∏—è
                this.position.y += Math.sin(this.animationTime * 3) * 10 * deltaTime;
            }

            shoot(player) {
                const direction = player.position.subtract(this.position).normalize();
                const projectile = new Projectile(
                    this.position,
                    direction.multiply(300),
                    new Vector2(8, 8),
                    '#ff5555',
                    10,
                    this
                );
                game.projectiles.push(projectile);
            }

            draw(ctx) {
                ctx.save();
                ctx.translate(this.position.x, this.position.y);
                ctx.rotate(this.animationTime);

                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
                switch(this.type) {
                    case 0: // –†–∞–∑–≤–µ–¥—á–∏–∫
                        ctx.fillStyle = this.color;
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size.x / 2, 0, Math.PI * 2);
                        ctx.fill();
                        
                        ctx.strokeStyle = '#ffffff';
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size.x / 2 - 2, 0, Math.PI * 2);
                        ctx.stroke();
                        break;

                    case 1: // –ò—Å—Ç—Ä–µ–±–∏—Ç–µ–ª—å
                        ctx.fillStyle = this.color;
                        ctx.beginPath();
                        ctx.moveTo(0, -this.size.y / 2);
                        ctx.lineTo(this.size.x / 2, this.size.y / 2);
                        ctx.lineTo(-this.size.x / 2, this.size.y / 2);
                        ctx.closePath();
                        ctx.fill();
                        break;

                    case 2: // –ë–æ—Å—Å
                        ctx.fillStyle = this.color;
                        ctx.beginPath();
                        for (let i = 0; i < 8; i++) {
                            const angle = (i / 8) * Math.PI * 2;
                            const radius = i % 2 === 0 ? this.size.x / 2 : this.size.x / 3;
                            const x = Math.cos(angle) * radius;
                            const y = Math.sin(angle) * radius;
                            if (i === 0) ctx.moveTo(x, y);
                            else ctx.lineTo(x, y);
                        }
                        ctx.closePath();
                        ctx.fill();
                        break;
                }

                // –ü–æ–ª–æ—Å–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
                if (this.health < this.maxHealth) {
                    const healthWidth = 40;
                    const healthHeight = 6;
                    const healthPercent = this.health / this.maxHealth;
                    
                    ctx.fillStyle = '#ff0000';
                    ctx.fillRect(-healthWidth / 2, -this.size.y / 2 - 15, healthWidth, healthHeight);
                    
                    ctx.fillStyle = '#00ff00';
                    ctx.fillRect(-healthWidth / 2, -this.size.y / 2 - 15, healthWidth * healthPercent, healthHeight);
                }

                ctx.restore();
            }

            takeDamage(amount) {
                this.health -= amount;
                if (this.health <= 0) {
                    this.destroy();
                    return true;
                }
                return false;
            }

            destroy() {
                this.active = false;
                createExplosion(this.position, this.size.x);
                game.score += this.type === 0 ? 100 : this.type === 1 ? 250 : 1000;
                updateScore();
                
                // –®–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏—è
                if (Math.random() < 0.3) {
                    createPowerup(this.position);
                }

                addMessage(`–í—Ä–∞–≥ —É–Ω–∏—á—Ç–æ–∂–µ–Ω! +${this.type === 0 ? 100 : this.type === 1 ? 250 : 1000} –æ—á–∫–æ–≤`);
            }
        }

        class Projectile extends GameObject {
            constructor(position, velocity, size, color, damage, owner) {
                super(position, velocity, size, color);
                this.damage = damage;
                this.owner = owner;
                this.lifeTime = 5; // —Å–µ–∫—É–Ω–¥
                this.age = 0;
                this.homing = false;
                this.target = null;
            }

            update(deltaTime) {
                super.update(deltaTime);
                this.age += deltaTime;

                if (this.age > this.lifeTime) {
                    this.active = false;
                }

                // –ù–∞–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ —Ü–µ–ª—å
                if (this.homing && !this.target) {
                    // –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–µ–≥–æ –≤—Ä–∞–≥–∞
                    let closest = null;
                    let closestDistance = Infinity;
                    
                    game.enemies.forEach(enemy => {
                        if (enemy.active) {
                            const dist = this.position.distanceTo(enemy.position);
                            if (dist < closestDistance) {
                                closestDistance = dist;
                                closest = enemy;
                            }
                        }
                    });

                    if (closest && closestDistance < 500) {
                        this.target = closest;
                    }
                }

                if (this.homing && this.target && this.target.active) {
                    const direction = this.target.position.subtract(this.position).normalize();
                    const turnRate = 5;
                    this.velocity = this.velocity.add(direction.multiply(turnRate * deltaTime));
                    
                    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
                    const speed = Math.sqrt(this.velocity.x * this.velocity.x + this.velocity.y * this.velocity.y);
                    if (speed > 500) {
                        this.velocity = this.velocity.multiply(500 / speed);
                    }
                }
            }

            draw(ctx) {
                ctx.save();
                ctx.translate(this.position.x, this.position.y);

                if (this.homing) {
                    // –¢–æ—Ä–ø–µ–¥–∞
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.moveTo(this.size.x / 2, 0);
                    ctx.lineTo(-this.size.x / 2, this.size.y / 2);
                    ctx.lineTo(-this.size.x / 2, -this.size.y / 2);
                    ctx.closePath();
                    ctx.fill();

                    // –°–ª–µ–¥
                    const trailLength = 20;
                    ctx.strokeStyle = '#ff00ff';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    ctx.beginPath();
                    ctx.moveTo(-this.size.x / 2, 0);
                    ctx.lineTo(-this.size.x / 2 - trailLength, 0);
                    ctx.stroke();
                } else {
                    // –õ–∞–∑–µ—Ä
                    const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, this.size.x / 2);
                    gradient.addColorStop(0, '#ffffff');
                    gradient.addColorStop(0.5, this.color);
                    gradient.addColorStop(1, 'transparent');

                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size.x / 2, 0, Math.PI * 2);
                    ctx.fill();
                }

                ctx.restore();
            }
        }

        class Powerup extends GameObject {
            constructor(position, type = 0) {
                const types = [
                    { color: '#00ff00', icon: '‚ù§Ô∏è', effect: 'health' },
                    { color: '#00ffff', icon: 'üõ°Ô∏è', effect: 'shield' },
                    { color: '#ffff00', icon: '‚ö°', effect: 'energy' },
                    { color: '#ff00ff', icon: 'üí£', effect: 'ammo' }
                ];

                super(
                    position,
                    new Vector2(0, 50),
                    new Vector2(25, 25),
                    types[type].color
                );

                this.type = type;
                this.effect = types[type].effect;
                this.icon = types[type].icon;
                this.rotationSpeed = 2;
                this.floatTime = 0;
            }

            update(deltaTime) {
                this.floatTime += deltaTime;
                this.position.y += Math.sin(this.floatTime * 3) * 20 * deltaTime;
                this.rotation += this.rotationSpeed * deltaTime;
                super.update(deltaTime);
            }

            draw(ctx) {
                ctx.save();
                ctx.translate(this.position.x, this.position.y);
                ctx.rotate(this.rotation);

                // –í–Ω–µ—à–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ
                const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, this.size.x);
                gradient.addColorStop(0, this.color);
                gradient.addColorStop(0.5, this.color + '80');
                gradient.addColorStop(1, 'transparent');

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(0, 0, this.size.x, 0, Math.PI * 2);
                ctx.fill();

                // –ò–∫–æ–Ω–∫–∞
                ctx.font = '20px Arial';
                ctx.fillStyle = '#ffffff';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(this.icon, 0, 0);

                ctx.restore();
            }

            applyEffect(player) {
                switch(this.effect) {
                    case 'health':
                        game.health = Math.min(100, game.health + 25);
                        addMessage('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–¥–æ—Ä–æ–≤—å–µ!');
                        break;
                    case 'shield':
                        game.shield = Math.min(100, game.shield + 30);
                        addMessage('–©–∏—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!');
                        break;
                    case 'energy':
                        game.energy = Math.min(100, game.energy + 40);
                        addMessage('–≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!');
                        break;
                    case 'ammo':
                        game.weapons[1].ammo = Math.min(game.weapons[1].maxAmmo, game.weapons[1].ammo + 2);
                        addMessage('–ë–æ–µ–∑–∞–ø–∞—Å –ø–æ–ø–æ–ª–Ω–µ–Ω!');
                        break;
                }
                updateUI();
                this.active = false;
            }
        }

        // ==================== –ò–ì–†–û–í–´–ï –§–£–ù–ö–¶–ò–ò ====================

        let player = null;
        let input = {
            up: false,
            down: false,
            left: false,
            right: false,
            shoot: false,
            mouseX: 0,
            mouseY: 0
        };

        let lastTime = 0;
        let spawnTimer = 0;
        let levelProgress = 0;

        function initGame() {
            player = new Player();
            game.enemies = [];
            game.projectiles = [];
            game.particles = [];
            game.powerups = [];
            
            game.score = 0;
            game.level = 1;
            game.health = 100;
            game.shield = 100;
            game.energy = 100;
            levelProgress = 0;

            updateUI();
            updateScore();
            addMessage('–ú–∏—Å—Å–∏—è –Ω–∞—á–∞—Ç–∞. –£–Ω–∏—á—Ç–æ–∂—å—Ç–µ –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤!');
        }

        function updateGame(deltaTime) {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
            player.update(deltaTime, input);

            // –°—Ç—Ä–µ–ª—å–±–∞
            if (input.shoot) {
                player.shoot();
            }

            // –û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –æ—Ä—É–∂–∏—è
            game.weapons.forEach(weapon => {
                if (weapon.heat > 0) {
                    weapon.heat = Math.max(0, weapon.heat - deltaTime * 10);
                }
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
            game.enemies = game.enemies.filter(enemy => {
                if (!enemy.active || enemy.isOutOfBounds({ width: canvas.width, height: canvas.height })) {
                    return false;
                }
                enemy.update(deltaTime, player);
                return true;
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–Ω–∞—Ä—è–¥–æ–≤
            game.projectiles = game.projectiles.filter(projectile => {
                if (!projectile.active || projectile.isOutOfBounds({ width: canvas.width, height: canvas.height })) {
                    return false;
                }
                projectile.update(deltaTime);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
                if (projectile.owner instanceof Player) {
                    // –°–Ω–∞—Ä—è–¥—ã –∏–≥—Ä–æ–∫–∞
                    game.enemies.forEach(enemy => {
                        if (enemy.active && 
                            projectile.position.distanceTo(enemy.position) < 
                            (projectile.size.x + enemy.size.x) / 2) {
                            if (enemy.takeDamage(projectile.damage)) {
                                levelProgress++;
                                checkLevelComplete();
                            }
                            projectile.active = false;
                            createExplosion(projectile.position, 20);
                        }
                    });
                } else if (projectile.owner instanceof Enemy) {
                    // –°–Ω–∞—Ä—è–¥—ã –≤—Ä–∞–≥–æ–≤
                    if (projectile.position.distanceTo(player.position) < 
                        (projectile.size.x + player.size.x) / 2) {
                        takeDamage(projectile.damage);
                        projectile.active = false;
                        createExplosion(projectile.position, 15);
                    }
                }

                return true;
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π
            game.powerups = game.powerups.filter(powerup => {
                if (!powerup.active || powerup.isOutOfBounds({ width: canvas.width, height: canvas.height })) {
                    return false;
                }
                powerup.update(deltaTime);
                
                // –ü–æ–¥–±–æ—Ä —É–ª—É—á—à–µ–Ω–∏—è
                if (powerup.position.distanceTo(player.position) < 
                    (powerup.size.x + player.size.x) / 2) {
                    powerup.applyEffect(player);
                    createExplosion(powerup.position, 30, '#00ff00');
                }
                
                return true;
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
            game.particles = game.particles.filter(particle => {
                particle.life -= deltaTime;
                return particle.life > 0;
            });

            // –°–ø–∞–≤–Ω –≤—Ä–∞–≥–æ–≤
            spawnTimer -= deltaTime;
            if (spawnTimer <= 0) {
                const enemyType = Math.random() < 0.7 ? 0 : 1;
                game.enemies.push(new Enemy(enemyType));
                spawnTimer = 2 + Math.random() * 3;
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
            if (game.shield < 100 && game.energy > 10) {
                game.shield += deltaTime * 5;
                game.energy -= deltaTime * 2;
            }

            if (game.energy < 100) {
                game.energy += deltaTime * 3;
            }

            updateUI();
        }

        function drawGame() {
            // –û—á–∏—Å—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∞
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä–æ–∫–∞
            player.draw(ctx);

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—Ä–∞–≥–æ–≤
            game.enemies.forEach(enemy => enemy.draw(ctx));

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–Ω–∞—Ä—è–¥–æ–≤
            game.projectiles.forEach(projectile => projectile.draw(ctx));

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π
            game.powerups.forEach(powerup => powerup.draw(ctx));

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —á–∞—Å—Ç–∏—Ü
            game.particles.forEach(particle => {
                ctx.fillStyle = `rgba(255, 255, 255, ${particle.life})`;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
            });

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–∏–Ω–∏-–∫–∞—Ä—Ç—ã
            drawMinimap();
        }

        function drawMinimap() {
            minimapCtx.clearRect(0, 0, minimapCanvas.width, minimapCanvas.height);
            
            // –°–µ—Ç–∫–∞
            minimapCtx.strokeStyle = 'rgba(0, 255, 0, 0.3)';
            minimapCtx.lineWidth = 1;
            
            for (let x = 0; x < minimapCanvas.width; x += 20) {
                minimapCtx.beginPath();
                minimapCtx.moveTo(x, 0);
                minimapCtx.lineTo(x, minimapCanvas.height);
                minimapCtx.stroke();
            }
            
            for (let y = 0; y < minimapCanvas.height; y += 20) {
                minimapCtx.beginPath();
                minimapCtx.moveTo(0, y);
                minimapCtx.lineTo(minimapCanvas.width, y);
                minimapCtx.stroke();
            }

            // –ò–≥—Ä–æ–∫
            const playerX = (player.position.x / canvas.width) * minimapCanvas.width;
            const playerY = (player.position.y / canvas.height) * minimapCanvas.height;
            
            minimapCtx.fillStyle = '#00ffff';
            minimapCtx.beginPath();
            minimapCtx.arc(playerX, playerY, 4, 0, Math.PI * 2);
            minimapCtx.fill();

            // –í—Ä–∞–≥–∏
            game.enemies.forEach(enemy => {
                const enemyX = (enemy.position.x / canvas.width) * minimapCanvas.width;
                const enemyY = (enemy.position.y / canvas.height) * minimapCanvas.height;
                
                minimapCtx.fillStyle = enemy.type === 0 ? '#ff5555' : enemy.type === 1 ? '#ff0000' : '#ff00ff';
                minimapCtx.beginPath();
                minimapCtx.arc(enemyX, enemyY, enemy.type === 2 ? 6 : 3, 0, Math.PI * 2);
                minimapCtx.fill();
            });

            // –£–ª—É—á—à–µ–Ω–∏—è
            game.powerups.forEach(powerup => {
                const powerupX = (powerup.position.x / canvas.width) * minimapCanvas.width;
                const powerupY = (powerup.position.y / canvas.height) * minimapCanvas.height;
                
                minimapCtx.fillStyle = powerup.color;
                minimapCtx.beginPath();
                minimapCtx.arc(powerupX, powerupY, 2, 0, Math.PI * 2);
                minimapCtx.fill();
            });
        }

        function createExplosion(position, size, color = '#ff5500') {
            // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü –≤–∑—Ä—ã–≤–∞
            for (let i = 0; i < 30; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 100 + 50;
                const velocity = new Vector2(
                    Math.cos(angle) * speed,
                    Math.sin(angle) * speed
                );

                game.particles.push({
                    x: position.x,
                    y: position.y,
                    size: Math.random() * 3 + 2,
                    velocity: velocity,
                    life: 1,
                    color: color
                });
            }

            playSound('explosion-sound');
        }

        function createPowerup(position) {
            const type = Math.floor(Math.random() * 4);
            game.powerups.push(new Powerup(position, type));
        }

        function takeDamage(amount) {
            // –°–Ω–∞—á–∞–ª–∞ –ø–æ–≥–ª–æ—â–∞–µ—Ç—Å—è —â–∏—Ç–∞–º–∏
            if (game.shield > 0) {
                game.shield = Math.max(0, game.shield - amount);
                if (game.shield <= 0) {
                    addMessage('–©–∏—Ç—ã –ø—Ä–æ–±–∏—Ç—ã!');
                }
            } else {
                game.health = Math.max(0, game.health - amount);
                if (game.health <= 0) {
                    gameOver();
                }
            }

            // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è
            const damageOverlay = document.getElementById('damage-overlay');
            damageOverlay.classList.add('damage-flash');
            setTimeout(() => damageOverlay.classList.remove('damage-flash'), 300);

            updateUI();
        }

        function gameOver() {
            currentState = GameState.GAME_OVER;
            showNotification('–ö–û–†–ê–ë–õ–¨ –£–ù–ò–ß–¢–û–ñ–ï–ù');
            setTimeout(() => {
                showNotification(`–§–ò–ù–ê–õ–¨–ù–´–ô –°–ß–ï–¢: ${game.score}`);
                setTimeout(() => {
                    currentState = GameState.MENU;
                    document.getElementById('main-menu').classList.remove('hidden');
                }, 3000);
            }, 2000);
        }

        function checkLevelComplete() {
            if (levelProgress >= 10) {
                game.level++;
                levelProgress = 0;
                
                // –°–ø–∞–≤–Ω –±–æ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 3 —É—Ä–æ–≤–Ω—è
                if (game.level % 3 === 0) {
                    game.enemies.push(new Enemy(2));
                    showNotification(`–ü–û–Ø–í–ò–õ–°–Ø –ë–û–°–°! –£–†–û–í–ï–ù–¨ ${game.level}`);
                } else {
                    showNotification(`–£–†–û–í–ï–ù–¨ ${game.level} –ü–†–û–ô–î–ï–ù!`);
                }
                
                updateUI();
            }
        }

        // ==================== –ò–ù–¢–ï–†–§–ï–ô–° ====================

        function updateUI() {
            document.getElementById('health-fill').style.width = `${game.health}%`;
            document.getElementById('shield-fill').style.width = `${game.shield}%`;
            document.getElementById('energy-fill').style.width = `${game.energy}%`;
            document.getElementById('level-value').textContent = game.level;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞ –æ—Ä—É–∂–∏—è
            const weaponSlots = document.querySelectorAll('.weapon-slot');
            weaponSlots.forEach((slot, index) => {
                const weapon = game.weapons[index];
                const heatIndicator = slot.querySelector('.weapon-stats');
                if (heatIndicator && weapon.heat) {
                    if (index === 0) {
                        heatIndicator.innerHTML = `<span>–£—Ä–æ–Ω: 15</span><span>–¢–µ–ø–ª–æ: ${Math.round(weapon.heat)}%</span>`;
                    }
                }
            });
        }

        function updateScore() {
            document.getElementById('score-value').textContent = game.score;
        }

        function updateWeaponDisplay() {
            const weaponSlots = document.querySelectorAll('.weapon-slot');
            weaponSlots.forEach((slot, index) => {
                if (index === game.activeWeapon) {
                    slot.classList.add('active');
                } else {
                    slot.classList.remove('active');
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Ä—É–∂–∏–∏
                const weapon = game.weapons[index];
                const stats = slot.querySelector('.weapon-stats');
                if (index === 1) { // –¢–æ—Ä–ø–µ–¥—ã
                    stats.innerHTML = `<span>–£—Ä–æ–Ω: 150</span><span>–ó–∞—Ä—è–¥—ã: ${weapon.ammo}/${weapon.maxAmmo}</span>`;
                }
            });
        }

        function addMessage(text) {
            const messagesContainer = document.getElementById('messages-container');
            const message = document.createElement('div');
            message.className = 'message';
            message.textContent = `[${new Date().toLocaleTimeString().slice(0,5)}] ${text}`;
            
            messagesContainer.appendChild(message);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
            while (messagesContainer.children.length > 10) {
                messagesContainer.removeChild(messagesContainer.firstChild);
            }
        }

        function showNotification(text) {
            const notification = document.getElementById('notification');
            notification.textContent = text;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }

        // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï ====================

        document.addEventListener('keydown', (e) => {
            switch(e.code) {
                case 'ArrowUp':
                case 'KeyW':
                    input.up = true;
                    break;
                case 'ArrowDown':
                case 'KeyS':
                    input.down = true;
                    break;
                case 'ArrowLeft':
                case 'KeyA':
                    input.left = true;
                    break;
                case 'ArrowRight':
                case 'KeyD':
                    input.right = true;
                    break;
                case 'Space':
                    input.shoot = true;
                    e.preventDefault();
                    break;
                case 'Digit1':
                    game.activeWeapon = 0;
                    updateWeaponDisplay();
                    break;
                case 'Digit2':
                    game.activeWeapon = 1;
                    updateWeaponDisplay();
                    break;
                case 'Digit3':
                    game.activeWeapon = 2;
                    updateWeaponDisplay();
                    break;
                case 'Escape':
                    if (currentState === GameState.PLAYING) {
                        pauseGame();
                    } else if (currentState === GameState.PAUSED) {
                        resumeGame();
                    }
                    break;
                case 'KeyP':
                    if (currentState === GameState.PLAYING) {
                        game.health = Math.min(100, game.health + 50);
                        updateUI();
                    }
                    break;
            }
        });

        document.addEventListener('keyup', (e) => {
            switch(e.code) {
                case 'ArrowUp':
                case 'KeyW':
                    input.up = false;
                    break;
                case 'ArrowDown':
                case 'KeyS':
                    input.down = false;
                    break;
                case 'ArrowLeft':
                case 'KeyA':
                    input.left = false;
                    break;
                case 'ArrowRight':
                case 'KeyD':
                    input.right = false;
                    break;
                case 'Space':
                    input.shoot = false;
                    break;
            }
        });

        document.addEventListener('mousedown', (e) => {
            if (currentState === GameState.PLAYING) {
                input.shoot = true;
            }
        });

        document.addEventListener('mouseup', (e) => {
            if (currentState === GameState.PLAYING) {
                input.shoot = false;
            }
        });

        document.addEventListener('mousemove', (e) => {
            input.mouseX = e.clientX;
            input.mouseY = e.clientY;
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ—Ä—É–∂–∏—è –ø–æ –∫–æ–ª–µ—Å–∏–∫—É –º—ã—à–∏
        document.addEventListener('wheel', (e) => {
            if (currentState === GameState.PLAYING) {
                if (e.deltaY > 0) {
                    game.activeWeapon = (game.activeWeapon + 1) % 3;
                } else {
                    game.activeWeapon = (game.activeWeapon + 2) % 3;
                }
                updateWeaponDisplay();
            }
        });

        // ==================== –ú–ï–ù–Æ –ò –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ì–†–û–ô ====================

        function startNewGame() {
            document.getElementById('main-menu').classList.add('hidden');
            currentState = GameState.PLAYING;
            initGame();
            playSound('engine-sound');
        }

        function continueGame() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            showNotification('–°–û–•–†–ê–ù–ï–ù–ò–ô –ù–ï –ù–ê–ô–î–ï–ù–û');
        }

        function pauseGame() {
            currentState = GameState.PAUSED;
            document.getElementById('pause-modal').classList.add('active');
        }

        function resumeGame() {
            currentState = GameState.PLAYING;
            document.getElementById('pause-modal').classList.remove('active');
        }

        function saveGame() {
            const saveData = {
                score: game.score,
                level: game.level,
                health: game.health,
                shield: game.shield,
                weapons: game.weapons
            };
            
            localStorage.setItem('starforge_save', JSON.stringify(saveData));
            showNotification('–ò–ì–†–ê –°–û–•–†–ê–ù–ï–ù–ê');
        }

        function returnToMenu() {
            currentState = GameState.MENU;
            document.getElementById('pause-modal').classList.remove('active');
            document.getElementById('main-menu').classList.remove('hidden');
        }

        function showOptions() {
            document.getElementById('options-modal').classList.add('active');
        }

        function closeOptions() {
            document.getElementById('options-modal').classList.remove('active');
        }

        function saveOptions() {
            const volume = document.getElementById('volume-slider').value;
            document.getElementById('volume-value').textContent = `${volume}%`;
            showNotification('–ù–ê–°–¢–†–û–ô–ö–ò –°–û–•–†–ê–ù–ï–ù–´');
            setTimeout(closeOptions, 1000);
        }

        function showCredits() {
            document.getElementById('credits-modal').classList.add('active');
        }

        function closeCredits() {
            document.getElementById('credits-modal').classList.remove('active');
        }

        function quitGame() {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?')) {
                window.close();
            }
        }

        function playSound(soundId) {
            const sound = document.getElementById(soundId);
            if (sound) {
                sound.currentTime = 0;
                sound.volume = document.getElementById('volume-slider').value / 100;
                sound.play().catch(e => console.log('Audio play failed:', e));
            }
        }

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò –ì–õ–ê–í–ù–´–ô –¶–ò–ö–õ ====================

        function simulateLoading() {
            let progress = 0;
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(loadingInterval);
                    setTimeout(() => {
                        document.getElementById('loading-screen').classList.add('hidden');
                        document.getElementById('main-menu').classList.remove('hidden');
                    }, 500);
                }
                
                document.getElementById('loading-progress').style.width = `${progress}%`;
                
                const statuses = [
                    '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π...',
                    '–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º –≤–æ–æ—Ä—É–∂–µ–Ω–∏—è...',
                    '–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...',
                    '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ–æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è...',
                    '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç –≥–∞–ª–∞–∫—Ç–∏–∫–∏...',
                    '–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!'
                ];
                
                const statusIndex = Math.floor(progress / 20);
                if (statusIndex < statuses.length) {
                    document.getElementById('loading-status').textContent = statuses[statusIndex];
                }
            }, 200);
        }

        function gameLoop(timestamp) {
            if (!lastTime) lastTime = timestamp;
            const deltaTime = (timestamp - lastTime) / 1000;
            lastTime = timestamp;

            if (currentState === GameState.PLAYING) {
                updateGame(deltaTime);
                drawGame();
            }

            requestAnimationFrame(gameLoop);
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        window.addEventListener('load', () => {
            resizeCanvas();
            simulateLoading();
            gameLoop(0);
        });

        window.addEventListener('resize', resizeCanvas);

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
        document.addEventListener('contextmenu', e => e.preventDefault());

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        document.querySelectorAll('.weapon-slot').forEach(slot => {
            slot.addEventListener('click', function() {
                const weaponIndex = parseInt(this.dataset.weapon);
                game.activeWeapon = weaponIndex;
                updateWeaponDisplay();
            });
        });

        console.log('STARFORGE –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω. –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É!');
        console.log('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:');
        console.log('WASD/–°—Ç—Ä–µ–ª–∫–∏ - –¥–≤–∏–∂–µ–Ω–∏–µ');
        console.log('–ü—Ä–æ–±–µ–ª - —Å—Ç—Ä–µ–ª—å–±–∞');
        console.log('1-3 - –≤—ã–±–æ—Ä –æ—Ä—É–∂–∏—è');
        console.log('–ö–æ–ª–µ—Å–æ –º—ã—à–∏ - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ—Ä—É–∂–∏—è');
        console.log('ESC - –ø–∞—É–∑–∞');
        console.log('P - —á–∏—Ç–µ—Ä—Å–∫–æ–µ –ª–µ—á–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)');
    </script>

    <!-- –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –°–ö–†–ò–ü–¢ –î–õ–Ø –î–ò–ù–ê–ú–ò–ß–ï–°–ö–û–ì–û –°–û–ó–î–ê–ù–ò–Ø –ó–í–ï–ó–î -->
    <script>
        // –°–æ–∑–¥–∞–Ω–∏–µ –∑–≤–µ–∑–¥ –¥–ª—è –ø–∞—Ä–∞–ª–ª–∞–∫—Å-—ç—Ñ—Ñ–µ–∫—Ç–∞
        function createStars() {
            const starLayers = document.querySelectorAll('.stars, .stars2, .stars3');
            
            starLayers.forEach((layer, layerIndex) => {
                const ctx = document.createElement('canvas').getContext('2d');
                const size = layerIndex === 0 ? 3000 : layerIndex === 1 ? 2000 : 1000;
                ctx.canvas.width = size;
                ctx.canvas.height = size;
                
                // –†–∏—Å—É–µ–º –∑–≤–µ–∑–¥—ã
                const starCount = layerIndex === 0 ? 1000 : layerIndex === 1 ? 500 : 200;
                for (let i = 0; i < starCount; i++) {
                    const x = Math.random() * size;
                    const y = Math.random() * size;
                    const radius = Math.random() * (layerIndex + 1) * 0.5;
                    const brightness = Math.random() * 0.5 + 0.5;
                    
                    ctx.fillStyle = `rgba(255, 255, 255, ${brightness})`;
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—á–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–≤–µ–∑–¥
                    if (Math.random() < 0.1) {
                        const gradient = ctx.createRadialGradient(x, y, 0, x, y, radius * 3);
                        gradient.addColorStop(0, `rgba(255, 255, 255, ${brightness})`);
                        gradient.addColorStop(1, 'transparent');
                        
                        ctx.fillStyle = gradient;
                        ctx.beginPath();
                        ctx.arc(x, y, radius * 3, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                layer.style.backgroundImage = `url(${ctx.canvas.toDataURL()})`;
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–µ–π
        function createNebulas() {
            const nebulaLayer = document.createElement('div');
            nebulaLayer.className = 'parallax-layer';
            nebulaLayer.style.zIndex = '1';
            nebulaLayer.style.opacity = '0.3';
            nebulaLayer.style.animation = 'stars-move 300s linear infinite';
            
            const ctx = document.createElement('canvas').getContext('2d');
            ctx.canvas.width = 2000;
            ctx.canvas.height = 2000;
            
            // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏
            const gradient1 = ctx.createRadialGradient(500, 500, 0, 500, 500, 800);
            gradient1.addColorStop(0, 'rgba(100, 0, 255, 0.3)');
            gradient1.addColorStop(1, 'transparent');
            
            const gradient2 = ctx.createRadialGradient(1500, 1500, 0, 1500, 1500, 600);
            gradient2.addColorStop(0, 'rgba(255, 0, 100, 0.2)');
            gradient2.addColorStop(1, 'transparent');
            
            ctx.fillStyle = gradient1;
            ctx.fillRect(0, 0, 2000, 2000);
            
            ctx.fillStyle = gradient2;
            ctx.fillRect(0, 0, 2000, 2000);
            
            nebulaLayer.style.backgroundImage = `url(${ctx.canvas.toDataURL()})`;
            document.getElementById('game-container').appendChild(nebulaLayer);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
        window.addEventListener('load', () => {
            setTimeout(() => {
                createStars();
                createNebulas();
            }, 100);
        });
    </script>
</body>
</html>