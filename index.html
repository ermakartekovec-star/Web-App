<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Genius AI | Веб-панель управления</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #06d6a0;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border-radius: 12px;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 20px 60px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.5rem;
            color: var(--success);
            background: rgba(76, 201, 240, 0.1);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--success), var(--primary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: var(--gray-light);
            opacity: 0.8;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 20px;
            border-radius: var(--border-radius);
            backdrop-filter: blur(10px);
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .user-details h3 {
            font-size: 1rem;
            font-weight: 600;
        }

        .user-details p {
            font-size: 0.85rem;
            color: var(--gray-light);
            opacity: 0.7;
        }

        /* Main Layout */
        .main-content {
            display: flex;
            gap: 30px;
        }

        /* Sidebar */
        .sidebar {
            flex: 0 0 280px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 25px;
            height: fit-content;
            backdrop-filter: blur(10px);
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 15px;
            opacity: 0.7;
        }

        .nav-links {
            list-style: none;
        }

        .nav-links li {
            margin-bottom: 8px;
        }

        .nav-links a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            color: var(--light);
            text-decoration: none;
            border-radius: 10px;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .nav-links a.active {
            background: linear-gradient(90deg, rgba(67, 97, 238, 0.2), rgba(114, 9, 183, 0.2));
            border-left: 4px solid var(--primary);
        }

        .nav-links i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        /* Content Area */
        .content-area {
            flex: 1;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 25px;
            backdrop-filter: blur(10px);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .card-icon.green {
            background: rgba(76, 201, 240, 0.15);
            color: var(--success);
        }

        .card-icon.blue {
            background: rgba(67, 97, 238, 0.15);
            color: var(--primary);
        }

        .card-icon.purple {
            background: rgba(114, 9, 183, 0.15);
            color: var(--secondary);
        }

        .card-icon.red {
            background: rgba(247, 37, 133, 0.15);
            color: var(--danger);
        }

        .card-title h3 {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .card-title p {
            font-size: 0.85rem;
            color: var(--gray-light);
            opacity: 0.7;
        }

        .card-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .card-footer {
            font-size: 0.85rem;
            color: var(--gray-light);
            opacity: 0.7;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
        }

        .tab-btn {
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: var(--light);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .tab-btn.active {
            background: var(--primary);
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
        }

        /* Panels */
        .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .panel.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .panel-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--light);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        textarea.form-input {
            min-height: 150px;
            resize: vertical;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn i {
            font-size: 1.1rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .btn-small {
            padding: 10px 20px;
            font-size: 0.9rem;
        }

        /* Grid Layout */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 18px 15px;
            font-weight: 600;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray-light);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .table td {
            padding: 18px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .table tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-online {
            background: rgba(6, 214, 160, 0.15);
            color: var(--info);
        }

        .status-offline {
            background: rgba(247, 37, 133, 0.15);
            color: var(--danger);
        }

        .status-pending {
            background: rgba(248, 150, 30, 0.15);
            color: var(--warning);
        }

        /* Alerts */
        .alert {
            padding: 18px 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .alert-success {
            background: rgba(6, 214, 160, 0.15);
            border-left: 4px solid var(--info);
        }

        .alert-danger {
            background: rgba(247, 37, 133, 0.15);
            border-left: 4px solid var(--danger);
        }

        .alert-warning {
            background: rgba(248, 150, 30, 0.15);
            border-left: 4px solid var(--warning);
        }

        /* AI Chat */
        .ai-chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
        }

        .message {
            margin-bottom: 20px;
            max-width: 80%;
        }

        .message.user {
            margin-left: auto;
        }

        .message-content {
            padding: 15px 20px;
            border-radius: 18px;
            position: relative;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message.ai .message-content {
            background: rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 5px;
        }

        .ai-chat-input {
            display: flex;
            gap: 15px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.4);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-chat-input input {
            flex: 1;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--light);
            font-size: 1rem;
        }

        /* PC Control Cards */
        .pc-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .pc-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .pc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .pc-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pc-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .pc-actions .btn {
            flex: 1;
            justify-content: center;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95), rgba(48, 43, 99, 0.95));
            border-radius: var(--border-radius);
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
        }

        .modal-close:hover {
            opacity: 1;
        }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 50px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                flex: none;
                width: 100%;
            }
            
            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .tabs {
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .tab-btn {
                white-space: nowrap;
            }
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 25px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray-light);
            font-size: 0.9rem;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="logo-text">
                    <h1>E-Genius AI</h1>
                    <p>Веб-панель управления системой</p>
                </div>
            </div>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">A</div>
                <div class="user-details">
                    <h3 id="userName">Администратор</h3>
                    <p id="userRole">Уровень доступа: Админ</p>
                </div>
                <button class="btn btn-outline btn-small" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Выйти
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <nav class="sidebar">
                <div class="nav-section">
                    <h3>Основное</h3>
                    <ul class="nav-links">
                        <li><a href="#" class="active" data-panel="dashboard"><i class="fas fa-tachometer-alt"></i> Дашборд</a></li>
                        <li><a href="#" data-panel="ai"><i class="fas fa-robot"></i> ИИ-помощник</a></li>
                        <li><a href="#" data-panel="emails"><i class="fas fa-envelope"></i> Email управление</a></li>
                        <li><a href="#" data-panel="pc"><i class="fas fa-desktop"></i> Управление ПК</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Рассылки</h3>
                    <ul class="nav-links">
                        <li><a href="#" data-panel="broadcast-tg"><i class="fab fa-telegram"></i> Telegram рассылка</a></li>
                        <li><a href="#" data-panel="broadcast-email"><i class="fas fa-mail-bulk"></i> Email рассылка</a></li>
                        <li><a href="#" data-panel="chats"><i class="fas fa-comments"></i> Мои чаты</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Настройки</h3>
                    <ul class="nav-links">
                        <li><a href="#" data-panel="settings"><i class="fas fa-cog"></i> Настройки системы</a></li>
                        <li><a href="#" data-panel="users"><i class="fas fa-users"></i> Пользователи</a></li>
                        <li><a href="#" data-panel="platon"><i class="fas fa-user-shield"></i> Платон</a></li>
                        <li><a href="#" data-panel="ermak-app"><i class="fas fa-globe"></i> ERMAK APP</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Статистика</h3>
                    <ul class="nav-links">
                        <li><a href="#" data-panel="stats"><i class="fas fa-chart-bar"></i> Аналитика</a></li>
                        <li><a href="#" data-panel="logs"><i class="fas fa-history"></i> Логи событий</a></li>
                    </ul>
                </div>
            </nav>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Panel -->
                <div class="panel active" id="dashboard">
                    <div class="panel-header">
                        <h2><i class="fas fa-tachometer-alt"></i> Дашборд</h2>
                        <div class="tabs">
                            <button class="tab-btn active" data-tab="overview">Обзор</button>
                            <button class="tab-btn" data-tab="quick-actions">Быстрые действия</button>
                        </div>
                    </div>
                    
                    <!-- Dashboard Cards -->
                    <div class="dashboard-cards">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon green">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="card-title">
                                    <h3>Пользователи</h3>
                                    <p>Всего в системе</p>
                                </div>
                            </div>
                            <div class="card-value" id="usersCount">0</div>
                            <div class="card-footer">+2 за сегодня</div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon blue">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="card-title">
                                    <h3>Email адреса</h3>
                                    <p>В базе данных</p>
                                </div>
                            </div>
                            <div class="card-value" id="emailsCount">0</div>
                            <div class="card-footer">+5 за неделю</div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon purple">
                                    <i class="fas fa-desktop"></i>
                                </div>
                                <div class="card-title">
                                    <h3>Активные ПК</h3>
                                    <p>В сети сейчас</p>
                                </div>
                            </div>
                            <div class="card-value" id="pcsCount">0</div>
                            <div class="card-footer">Из 12 доступных</div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon red">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="card-title">
                                    <h3>Запросы к ИИ</h3>
                                    <p>За сегодня</p>
                                </div>
                            </div>
                            <div class="card-value" id="aiRequestsCount">0</div>
                            <div class="card-footer">Безлимитно для всех</div>
                        </div>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="grid-2">
                        <div class="panel">
                            <h3>Статус системы</h3>
                            <div class="form-group">
                                <label>Google Drive</label>
                                <div class="status-badge status-online">
                                    <i class="fas fa-circle"></i> Подключен
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Telegram Bot</label>
                                <div class="status-badge status-online">
                                    <i class="fas fa-circle"></i> Активен
                                </div>
                            </div>
                            <div class="form-group">
                                <label>OpenRouter API</label>
                                <div class="status-badge status-online">
                                    <i class="fas fa-circle"></i> Доступен
                                </div>
                            </div>
                        </div>
                        
                        <div class="panel">
                            <h3>Последние действия</h3>
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Время</th>
                                            <th>Действие</th>
                                            <th>Пользователь</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recentActivities">
                                        <!-- Заполнится JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Assistant Panel -->
                <div class="panel" id="ai">
                    <div class="panel-header">
                        <h2><i class="fas fa-robot"></i> ИИ-помощник</h2>
                        <button class="btn btn-outline" id="clearChatBtn">
                            <i class="fas fa-trash"></i> Очистить чат
                        </button>
                    </div>
                    
                    <div class="ai-chat-container">
                        <div class="ai-chat-messages" id="chatMessages">
                            <div class="message ai">
                                <div class="message-content">
                                    Привет! Я ваш ИИ-помощник E-Genius. Чем могу помочь сегодня?
                                </div>
                            </div>
                        </div>
                        <div class="ai-chat-input">
                            <input type="text" id="aiInput" placeholder="Введите ваш вопрос... (Enter для отправки)">
                            <button class="btn btn-primary" id="sendAiBtn">
                                <i class="fas fa-paper-plane"></i> Отправить
                            </button>
                        </div>
                    </div>
                    
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Информация:</strong> Используется модель allenai/molmo-2-8b:free. 
                            Отвечаю на русском языке. Безлимитное использование для всех пользователей.
                        </div>
                    </div>
                </div>

                <!-- Email Management Panel -->
                <div class="panel" id="emails">
                    <div class="panel-header">
                        <h2><i class="fas fa-envelope"></i> Управление Email</h2>
                        <button class="btn btn-primary" id="addEmailBtn">
                            <i class="fas fa-plus"></i> Добавить email
                        </button>
                    </div>
                    
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="my-emails">Мои email</button>
                        <button class="tab-btn" data-tab="all-emails">Все email</button>
                        <button class="tab-btn" data-tab="add-email">Добавить</button>
                    </div>
                    
                    <div class="tab-content active" data-tab-content="my-emails">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Email</th>
                                        <th>Дата добавления</th>
                                        <th>Статус</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="myEmailsTable">
                                    <!-- Заполнится JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" data-tab-content="all-emails">
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div>
                                <strong>Только для администратора:</strong> Просмотр всех email адресов в системе
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Email</th>
                                        <th>Пользователь</th>
                                        <th>Дата добавления</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="allEmailsTable">
                                    <!-- Заполнится JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" data-tab-content="add-email">
                        <div class="form-group">
                            <label class="form-label">Email адрес</label>
                            <input type="email" class="form-input" id="newEmail" placeholder="user@example.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Тип добавления</label>
                            <select class="form-input" id="emailType">
                                <option value="user">Для себя</option>
                                <option value="admin">Как администратор (для другого пользователя)</option>
                            </select>
                        </div>
                        <button class="btn btn-success" id="saveEmailBtn">
                            <i class="fas fa-save"></i> Сохранить email
                        </button>
                    </div>
                </div>

                <!-- PC Control Panel -->
                <div class="panel" id="pc">
                    <div class="panel-header">
                        <h2><i class="fas fa-desktop"></i> Управление ПК</h2>
                        <button class="btn btn-primary" id="refreshPcsBtn">
                            <i class="fas fa-sync-alt"></i> Обновить список
                        </button>
                    </div>
                    
                    <div class="grid-3" id="pcsGrid">
                        <!-- PC Cards будут добавлены JavaScript -->
                        <div class="loading" id="pcsLoading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Информация:</strong> Для управления ПК на них должен быть запущен скрипт управления. 
                            Команды выполняются в течение 10 секунд после отправки.
                        </div>
                    </div>
                </div>

                <!-- Add more panels here for other sections -->
                <!-- Telegram Broadcast Panel -->
                <div class="panel" id="broadcast-tg">
                    <div class="panel-header">
                        <h2><i class="fab fa-telegram"></i> Telegram рассылка</h2>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Сообщение для рассылки</label>
                        <textarea class="form-input" id="tgMessage" placeholder="Введите текст для рассылки всем пользователям бота..."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Получатели: <span id="tgRecipientsCount">0</span> пользователей</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="tgProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <button class="btn btn-primary" id="sendTgBroadcastBtn">
                        <i class="fas fa-paper-plane"></i> Начать Telegram рассылку
                    </button>
                </div>

                <!-- Email Broadcast Panel -->
                <div class="panel" id="broadcast-email">
                    <div class="panel-header">
                        <h2><i class="fas fa-mail-bulk"></i> Email рассылка</h2>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Тема письма</label>
                        <input type="text" class="form-input" id="emailSubject" placeholder="Новости от E-Genius AI">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Текст письма</label>
                        <textarea class="form-input" id="emailBody" placeholder="Введите текст для email рассылки..." rows="6"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Получатели: <span id="emailRecipientsCount">0</span> email адресов</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="emailProgress" style="width: 0%"></div>
                        </div>
                    </div>
                    <button class="btn btn-success" id="sendEmailBroadcastBtn">
                        <i class="fas fa-envelope"></i> Начать Email рассылку
                    </button>
                </div>

                <!-- Settings Panel -->
                <div class="panel" id="settings">
                    <div class="panel-header">
                        <h2><i class="fas fa-cog"></i> Настройки системы</h2>
                    </div>
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Автоответ в канале</label>
                            <div class="form-group">
                                <label class="switch">
                                    <input type="checkbox" id="autoReplyToggle">
                                    <span class="slider"></span>
                                </label>
                                <span id="autoReplyStatus">Выключен</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ID Telegram канала</label>
                            <input type="text" class="form-input" id="channelId" placeholder="@channel_username">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Пароль администратора</label>
                        <input type="password" class="form-input" id="adminPassword" placeholder="Введите новый пароль">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Пароль Платона</label>
                        <input type="password" class="form-input" id="platonPassword" placeholder="Введите новый пароль">
                    </div>
                    <button class="btn btn-primary" id="saveSettingsBtn">
                        <i class="fas fa-save"></i> Сохранить настройки
                    </button>
                </div>

                <!-- Platon Panel -->
                <div class="panel" id="platon">
                    <div class="panel-header">
                        <h2><i class="fas fa-user-shield"></i> Управление Платоном</h2>
                    </div>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Только для администратора:</strong> Отправка сообщений пользователю Платон
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Сообщение для Платона</label>
                        <textarea class="form-input" id="platonMessage" placeholder="Введите сообщение для пользователя Платон..." rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Активные пользователи Платон: <span id="platonUsersCount">0</span></label>
                    </div>
                    <button class="btn btn-primary" id="sendToPlatonBtn">
                        <i class="fas fa-paper-plane"></i> Отправить Платону
                    </button>
                </div>

                <!-- ERMAK APP Panel -->
                <div class="panel" id="ermak-app">
                    <div class="panel-header">
                        <h2><i class="fas fa-globe"></i> ERMAK APP</h2>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon green">
                                <i class="fas fa-rocket"></i>
                            </div>
                            <div class="card-title">
                                <h3>Открыть ERMAK APP</h3>
                                <p>Веб-приложение управления</p>
                            </div>
                        </div>
                        <div class="card-value" style="font-size: 1.5rem; margin-bottom: 20px;">
                            Доступно для всех пользователей
                        </div>
                        <a href="https://t.me/EGenius_AI_bot/ermak_app" target="_blank" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-external-link-alt"></i> Открыть ERMAK APP в новом окне
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>© 2024 E-Genius AI System. Все права защищены. | Версия 2.0</p>
            <p style="margin-top: 10px; font-size: 0.8rem;">
                <i class="fas fa-cloud"></i> Данные хранятся в Google Drive | 
                <i class="fas fa-bolt"></i> Работает на OpenRouter AI
            </p>
        </footer>
    </div>

    <!-- Modals -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <button class="modal-close" id="closeAuthModal">&times;</button>
            <h2 style="margin-bottom: 25px;"><i class="fas fa-lock"></i> Авторизация</h2>
            <div class="form-group">
                <label class="form-label">Введите пароль для доступа</label>
                <input type="password" class="form-input" id="authPassword" placeholder="Пароль администратора или Платона">
            </div>
            <div class="form-group">
                <select class="form-input" id="authType">
                    <option value="admin">Администратор</option>
                    <option value="platon">Платон</option>
                    <option value="guest">Гость</option>
                </select>
            </div>
            <button class="btn btn-primary" id="loginBtn" style="width: 100%;">
                <i class="fas fa-sign-in-alt"></i> Войти
            </button>
            <div class="alert alert-info" style="margin-top: 20px;">
                <i class="fas fa-info-circle"></i>
                <div>
                    <strong>Гости</strong> могут использовать ИИ-помощник без ограничений
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="commandModal">
        <div class="modal-content">
            <button class="modal-close" id="closeCommandModal">&times;</button>
            <h2 style="margin-bottom: 25px;" id="commandModalTitle"></h2>
            <div class="form-group">
                <label class="form-label" id="commandModalText"></label>
                <div class="pcs-list" id="commandPcsList" style="margin-top: 15px;">
                    <!-- Список ПК -->
                </div>
            </div>
            <button class="btn btn-primary" id="confirmCommandBtn" style="width: 100%;">
                <i class="fas fa-check"></i> Подтвердить команду
            </button>
        </div>
    </div>

    <script>
        // Конфигурация и состояние приложения
        const config = {
            BOT_TOKEN: "",
            PASSWORD_ADMIN: "",
            PASSWORD_PLATON: "",
            OPENROUTER_KEY: "",
            EMAIL_SENDER: "",
            EMAIL_PASSWORD: ""
        };

        let currentUser = {
            id: 0,
            name: "Гость",
            role: "guest",
            avatar: "G"
        };

        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // Основная функция инициализации
        function initializeApp() {
            loadConfig();
            setupEventListeners();
            checkAuth();
            loadDashboardData();
        }

        // Загрузка конфигурации
        function loadConfig() {
            // Здесь будет загрузка из Google Drive
            console.log("Загрузка конфигурации...");
            
            // Временные тестовые данные
            currentUser = {
                id: 1,
                name: "Администратор",
                role: "admin",
                avatar: "A"
            };
            
            updateUIForUserRole();
        }

        // Проверка авторизации
        function checkAuth() {
            const savedUser = localStorage.getItem('eGeniusUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    updateUIForUserRole();
                } catch (e) {
                    showAuthModal();
                }
            } else {
                showAuthModal();
            }
        }

        // Обновление UI в зависимости от роли пользователя
        function updateUIForUserRole() {
            // Обновление информации о пользователе
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = `Уровень доступа: ${getRoleName(currentUser.role)}`;
            document.getElementById('userAvatar').textContent = currentUser.avatar;
            
            // Сохранение в localStorage
            localStorage.setItem('eGeniusUser', JSON.stringify(currentUser));
            
            // Показать/скрыть элементы в зависимости от роли
            const adminOnlyElements = document.querySelectorAll('.admin-only');
            const platonOnlyElements = document.querySelectorAll('.platon-only');
            
            adminOnlyElements.forEach(el => {
                el.style.display = currentUser.role === 'admin' ? 'block' : 'none';
            });
            
            platonOnlyElements.forEach(el => {
                el.style.display = currentUser.role === 'platon' ? 'block' : 'none';
            });
            
            // Обновить цвет аватара
            const avatar = document.getElementById('userAvatar');
            switch(currentUser.role) {
                case 'admin':
                    avatar.style.background = 'linear-gradient(135deg, #f72585, #7209b7)';
                    break;
                case 'platon':
                    avatar.style.background = 'linear-gradient(135deg, #4cc9f0, #4361ee)';
                    break;
                default:
                    avatar.style.background = 'linear-gradient(135deg, #6c757d, #495057)';
            }
        }

        function getRoleName(role) {
            switch(role) {
                case 'admin': return 'Администратор';
                case 'platon': return 'Платон';
                default: return 'Гость';
            }
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Навигация в сайдбаре
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const panelId = this.getAttribute('data-panel');
                    showPanel(panelId);
                    
                    // Обновление активного класса
                    document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Вкладки
            document.querySelectorAll('.tab-btn').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Обновление активного класса
                    this.parentElement.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Показать соответствующий контент
                    const container = this.closest('.panel');
                    container.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    container.querySelector(`[data-tab-content="${tabId}"]`).classList.add('active');
                });
            });

            // Авторизация
            document.getElementById('loginBtn').addEventListener('click', handleLogin);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('closeAuthModal').addEventListener('click', () => {
                document.getElementById('authModal').classList.remove('active');
            });

            // ИИ-чат
            document.getElementById('sendAiBtn').addEventListener('click', sendAiMessage);
            document.getElementById('aiInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendAiMessage();
            });
            document.getElementById('clearChatBtn').addEventListener('click', clearChat);

            // Email управление
            document.getElementById('addEmailBtn').addEventListener('click', () => {
                document.querySelector('[data-tab="add-email"]').click();
            });
            document.getElementById('saveEmailBtn').addEventListener('click', saveEmail);

            // Управление ПК
            document.getElementById('refreshPcsBtn').addEventListener('click', loadPcs);

            // Рассылки
            document.getElementById('sendTgBroadcastBtn').addEventListener('click', sendTelegramBroadcast);
            document.getElementById('sendEmailBroadcastBtn').addEventListener('click', sendEmailBroadcast);

            // Настройки
            document.getElementById('saveSettingsBtn').addEventListener('click', saveSettings);
            document.getElementById('autoReplyToggle').addEventListener('change', toggleAutoReply);

            // Платон
            document.getElementById('sendToPlatonBtn').addEventListener('click', sendToPlaton);

            // Команды ПК
            document.getElementById('confirmCommandBtn').addEventListener('click', executePcCommand);
            document.getElementById('closeCommandModal').addEventListener('click', () => {
                document.getElementById('commandModal').classList.remove('active');
            });
        }

        // Показать панель
        function showPanel(panelId) {
            document.querySelectorAll('.panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(panelId).classList.add('active');
        }

        // Показать модальное окно авторизации
        function showAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        // Обработка авторизации
        function handleLogin() {
            const password = document.getElementById('authPassword').value;
            const authType = document.getElementById('authType').value;
            
            // В реальном приложении здесь будет проверка с сервером
            // Для демо используем простую проверку
            
            if (authType === 'guest') {
                currentUser = {
                    id: Date.now(),
                    name: "Гость",
                    role: "guest",
                    avatar: "G"
                };
            } else {
                // Проверка пароля (в реальном приложении - запрос к API)
                if (password === config.PASSWORD_ADMIN && authType === 'admin') {
                    currentUser = {
                        id: 1,
                        name: "Администратор",
                        role: "admin",
                        avatar: "A"
                    };
                } else if (password === config.PASSWORD_PLATON && authType === 'platon') {
                    currentUser = {
                        id: 2,
                        name: "Платон Бердников",
                        role: "platon",
                        avatar: "П"
                    };
                } else {
                    alert("Неверный пароль!");
                    return;
                }
            }
            
            document.getElementById('authModal').classList.remove('active');
            updateUIForUserRole();
            loadDashboardData();
        }

        // Выход из системы
        function handleLogout() {
            localStorage.removeItem('eGeniusUser');
            currentUser = {
                id: 0,
                name: "Гость",
                role: "guest",
                avatar: "G"
            };
            updateUIForUserRole();
            showAuthModal();
        }

        // Загрузка данных для дашборда
        function loadDashboardData() {
            // Симулируем загрузку данных
            setTimeout(() => {
                document.getElementById('usersCount').textContent = '142';
                document.getElementById('emailsCount').textContent = '89';
                document.getElementById('pcsCount').textContent = '8';
                document.getElementById('aiRequestsCount').textContent = '156';
                
                // Заполняем последние действия
                const activities = [
                    {time: '10:23', action: 'Добавлен email', user: 'user@example.com'},
                    {time: '09:45', action: 'Отправлена команда ПК', user: 'PC-001'},
                    {time: '08:12', action: 'Выполнен запрос к ИИ', user: 'Пользователь #42'},
                    {time: '07:30', action: 'Обновлены настройки', user: 'Администратор'}
                ];
                
                const tbody = document.getElementById('recentActivities');
                tbody.innerHTML = activities.map(act => `
                    <tr>
                        <td>${act.time}</td>
                        <td>${act.action}</td>
                        <td>${act.user}</td>
                    </tr>
                `).join('');
                
                // Загружаем ПК
                loadPcs();
                
                // Загружаем email
                loadEmails();
            }, 1000);
        }

        // ИИ-помощник
        async function sendAiMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Добавляем сообщение пользователя
            addChatMessage(message, 'user');
            input.value = '';
            
            // Показываем индикатор загрузки
            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'message ai';
            loadingMsg.innerHTML = `
                <div class="message-content">
                    <i class="fas fa-spinner fa-spin"></i> Думаю...
                </div>
            `;
            document.getElementById('chatMessages').appendChild(loadingMsg);
            loadingMsg.scrollIntoView();
            
            try {
                // В реальном приложении здесь будет запрос к OpenRouter API
                // Для демо используем имитацию
                setTimeout(() => {
                    loadingMsg.remove();
                    
                    const responses = [
                        "Я ИИ-помощник E-Genius. Чем могу помочь?",
                        "Это веб-версия системы управления. Здесь доступны все функции Telegram бота.",
                        "Вы можете управлять ПК, отправлять рассылки, работать с email и многое другое.",
                        "Для использования полного функционала требуется авторизация.",
                        "Все данные хранятся в Google Drive для безопасности и доступности."
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addChatMessage(randomResponse, 'ai');
                }, 1500);
                
            } catch (error) {
                loadingMsg.remove();
                addChatMessage(`❌ Ошибка: ${error.message}`, 'ai');
            }
        }

        function addChatMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `
                <div class="message-content">
                    ${text}
                </div>
            `;
            messagesContainer.appendChild(messageDiv);
            messageDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function clearChat() {
            document.getElementById('chatMessages').innerHTML = `
                <div class="message ai">
                    <div class="message-content">
                        Привет! Я ваш ИИ-помощник E-Genius. Чем могу помочь сегодня?
                    </div>
                </div>
            `;
        }

        // Управление ПК
        async function loadPcs() {
            const grid = document.getElementById('pcsGrid');
            grid.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
            
            // Имитация загрузки данных
            setTimeout(() => {
                const pcs = [
                    {id: 'PC-001', name: 'Офисный ПК', status: 'online', user: 'Иван', lastSeen: '2 минуты назад', cpu: 45, memory: 78},
                    {id: 'PC-002', name: 'Сервер', status: 'online', user: 'Сергей', lastSeen: '1 минута назад', cpu: 12, memory: 34},
                    {id: 'PC-003', name: 'Ноутбук', status: 'offline', user: 'Мария', lastSeen: '5 часов назад', cpu: 0, memory: 0},
                    {id: 'PC-004', name: 'Домашний ПК', status: 'online', user: 'Алексей', lastSeen: '30 секунд назад', cpu: 67, memory: 89},
                    {id: 'PC-005', name: 'Тестовый стенд', status: 'online', user: 'Админ', lastSeen: '10 минут назад', cpu: 23, memory: 45},
                    {id: 'PC-006', name: 'Резервный сервер', status: 'offline', user: 'Система', lastSeen: '1 день назад', cpu: 0, memory: 0}
                ];
                
                grid.innerHTML = pcs.map(pc => `
                    <div class="pc-card">
                        <div class="pc-header">
                            <div>
                                <h3 style="margin-bottom: 5px;">${pc.name}</h3>
                                <p style="color: #aaa; font-size: 0.9rem;">ID: ${pc.id}</p>
                            </div>
                            <div class="pc-status ${pc.status === 'online' ? 'status-online' : 'status-offline'}">
                                <i class="fas fa-circle"></i> ${pc.status === 'online' ? 'Онлайн' : 'Оффлайн'}
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <p><i class="fas fa-user"></i> ${pc.user}</p>
                            <p><i class="fas fa-clock"></i> ${pc.lastSeen}</p>
                            <p><i class="fas fa-microchip"></i> CPU: ${pc.cpu}%</p>
                            <p><i class="fas fa-memory"></i> RAM: ${pc.memory}%</p>
                        </div>
                        ${pc.status === 'online' ? `
                        <div class="pc-actions">
                            <button class="btn btn-outline btn-small" onclick="showPcCommand('${pc.id}', 'screenshot')">
                                <i class="fas fa-camera"></i>
                            </button>
                            <button class="btn btn-outline btn-small" onclick="showPcCommand('${pc.id}', 'shutdown')">
                                <i class="fas fa-power-off"></i>
                            </button>
                            <button class="btn btn-outline btn-small" onclick="showPcCommand('${pc.id}', 'restart')">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="btn btn-outline btn-small" onclick="showPcCommand('${pc.id}', 'lock')">
                                <i class="fas fa-lock"></i>
                            </button>
                        </div>
                        ` : '<p style="color: #f72585; font-size: 0.9rem;">ПК недоступен</p>'}
                    </div>
                `).join('');
                
                document.getElementById('pcsCount').textContent = pcs.filter(pc => pc.status === 'online').length;
            }, 1500);
        }

        function showPcCommand(pcId, commandType) {
            if (currentUser.role !== 'admin') {
                alert('Только администратор может отправлять команды ПК');
                return;
            }
            
            const commandNames = {
                'shutdown': 'завершение работы',
                'restart': 'перезагрузка',
                'lock': 'блокировка',
                'screenshot': 'скриншот',
                'sleep': 'спящий режим',
                'hibernate': 'гибернация'
            };
            
            document.getElementById('commandModalTitle').textContent = `Команда: ${commandNames[commandType]}`;
            document.getElementById('commandModalText').textContent = `Подтвердите отправку команды "${commandNames[commandType]}" для ПК ${pcId}`;
            
            // Сохраняем данные команды
            document.getElementById('commandModal').dataset.pcId = pcId;
            document.getElementById('commandModal').dataset.commandType = commandType;
            
            document.getElementById('commandModal').classList.add('active');
        }

        function executePcCommand() {
            const modal = document.getElementById('commandModal');
            const pcId = modal.dataset.pcId;
            const commandType = modal.dataset.commandType;
            
            // Имитация отправки команды
            console.log(`Отправка команды ${commandType} на ПК ${pcId}`);
            
            // Показать уведомление
            alert(`✅ Команда отправлена на ПК ${pcId}!`);
            
            modal.classList.remove('active');
        }

        // Email управление
        async function loadEmails() {
            // Имитация загрузки email
            const myEmails = [
                {email: 'myemail@example.com', date: '2024-01-15', status: 'активен'},
                {email: 'work@company.com', date: '2024-01-10', status: 'активен'}
            ];
            
            const allEmails = [
                {email: 'user1@example.com', user: 'User #1', date: '2024-01-20'},
                {email: 'user2@example.com', user: 'User #2', date: '2024-01-19'},
                {email: 'admin@test.com', user: 'Администратор', date: '2024-01-18'},
                {email: 'platon@example.com', user: 'Платон', date: '2024-01-17'}
            ];
            
            // Заполняем таблицы
            document.getElementById('myEmailsTable').innerHTML = myEmails.map(email => `
                <tr>
                    <td>${email.email}</td>
                    <td>${email.date}</td>
                    <td><span class="status-badge status-online">${email.status}</span></td>
                    <td>
                        <button class="btn btn-outline btn-small">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            document.getElementById('allEmailsTable').innerHTML = allEmails.map(email => `
                <tr>
                    <td>${email.email}</td>
                    <td>${email.user}</td>
                    <td>${email.date}</td>
                    <td>
                        <button class="btn btn-outline btn-small">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Обновляем счетчики
            document.getElementById('emailsCount').textContent = allEmails.length;
            document.getElementById('emailRecipientsCount').textContent = allEmails.length;
        }

        function saveEmail() {
            const email = document.getElementById('newEmail').value;
            const type = document.getElementById('emailType').value;
            
            if (!email || !email.includes('@')) {
                alert('Введите корректный email адрес');
                return;
            }
            
            if (type === 'admin' && currentUser.role !== 'admin') {
                alert('Только администратор может добавлять email для других пользователей');
                return;
            }
            
            // Имитация сохранения
            console.log(`Сохранение email: ${email}, тип: ${type}`);
            alert(`✅ Email ${email} успешно добавлен!`);
            document.getElementById('newEmail').value = '';
            
            // Обновить список email
            loadEmails();
        }

        // Рассылки
        async function sendTelegramBroadcast() {
            const message = document.getElementById('tgMessage').value;
            
            if (!message) {
                alert('Введите сообщение для рассылки');
                return;
            }
            
            if (currentUser.role !== 'admin') {
                alert('Только администратор может делать рассылки');
                return;
            }
            
            // Имитация рассылки
            const progressBar = document.getElementById('tgProgress');
            const btn = document.getElementById('sendTgBroadcastBtn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Отправка...';
            btn.disabled = true;
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        alert(`✅ Telegram рассылка завершена! Сообщение отправлено 142 пользователям.`);
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        progressBar.style.width = '0%';
                    }, 500);
                }
            }, 200);
        }

        async function sendEmailBroadcast() {
            const subject = document.getElementById('emailSubject').value;
            const body = document.getElementById('emailBody').value;
            
            if (!subject || !body) {
                alert('Заполните тему и текст письма');
                return;
            }
            
            if (currentUser.role !== 'admin') {
                alert('Только администратор может делать email рассылки');
                return;
            }
            
            // Имитация рассылки
            const progressBar = document.getElementById('emailProgress');
            const btn = document.getElementById('sendEmailBroadcastBtn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Отправка...';
            btn.disabled = true;
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        alert(`✅ Email рассылка завершена! Письмо отправлено на 89 адресов.`);
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        progressBar.style.width = '0%';
                    }, 500);
                }
            }, 200);
        }

        // Настройки
        function saveSettings() {
            if (currentUser.role !== 'admin') {
                alert('Только администратор может изменять настройки');
                return;
            }
            
            const adminPass = document.getElementById('adminPassword').value;
            const platonPass = document.getElementById('platonPassword').value;
            const channelId = document.getElementById('channelId').value;
            
            // Имитация сохранения
            console.log('Сохранение настроек:', { adminPass, platonPass, channelId });
            alert('✅ Настройки успешно сохранены!');
            
            // Очистить поля паролей
            document.getElementById('adminPassword').value = '';
            document.getElementById('platonPassword').value = '';
        }

        function toggleAutoReply() {
            const toggle = document.getElementById('autoReplyToggle');
            const status = document.getElementById('autoReplyStatus');
            
            status.textContent = toggle.checked ? 'Включен' : 'Выключен';
        }

        // Отправка сообщения Платону
        function sendToPlaton() {
            if (currentUser.role !== 'admin') {
                alert('Только администратор может отправлять сообщения Платону');
                return;
            }
            
            const message = document.getElementById('platonMessage').value;
            
            if (!message) {
                alert('Введите сообщение для Платона');
                return;
            }
            
            // Имитация отправки
            console.log('Отправка Платону:', message);
            alert('✅ Сообщение отправлено пользователю Платон!');
            document.getElementById('platonMessage').value = '';
        }

        // Инициализация при загрузке
        window.onload = function() {
            // Показываем приветственное сообщение
            setTimeout(() => {
                if (currentUser.role === 'guest') {
                    alert('Добро пожаловать! Для доступа ко всем функциям требуется авторизация.');
                }
            }, 1000);
        };
    </script>
</body>
</html>